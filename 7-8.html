<!DOCTYPE html>
<meta charset="utf-8">
<html>
<body>
	<div id="result"></div>
</body>
</html>
<script>
	function Player(name){
		this.points = 0;
		this.name = name;
	}
	Player.prototype.play = function(){
		this.points ++;
		mediator.played();
	};

	var scoreboard = {
		element: document.getElementById('result'),

		update: function(score){
			var i, msg = '';
			for(i in score){
				if(score.hasOwnProperty(i)){
					msg += '<p><strong>' + i + '<\/strong>';
					msg += score[i];
					msg += '<\/p>';
				}
			}
			this.element.innerHTML = msg;
		}
	};

	var mediator = {
		// プレイヤー
		players: {},

		// 初期化
		setup: function(){
			var players = this.players;
			players.home = new Player('Home');
			players.guest = new Player('guest');
		},

		// プレイヤーの得点を更新
		played: function(){
			var players = this.players,
				score = {
					Home: players.home.points,
					Guest: players.guest.points
				};

			scoreboard.update(score);
		},

		// ユーザの操作を処理
		keypress: function(e){
			e = e || window.event;
			// キー "1"
			if(e.which === 49){
				mediator.players.home.play();
				return ;
			}
			// キー "0"
			if(e.which === 48){
				mediator.players.guest.play();
				return ;
			}
		}
	};

	// 開始
	mediator.setup();
	window.onkeypress = mediator.keypress;

	// 30秒経過したらゲーム終了
	setTimeout(function(){
		window.onkeypress = null;
		alert('Game over');
	},30000);
</script>
